<html>
<head>
<script src="3Dmol.js"></script>
</head>
<body>
<div id="tableDiv" style="height: 400px; width: 400px; position: relative;"></div>
</body>
<script>
var aminoAcidList = ["alanine", "arginine", "asparagine", "aspartic-acid", "cysteine", "glutamic-acid",
    "glutamine", "glycine", "histidine", "isoleucine", "leucine", "lysine", "methionine", "phenylalanine",
    "proline", "serine", "threonine", "tryptophan", "tyrosine", "valine"];

var buildTableFun = function(aminoAcidList) {
	var tableContents = "<table><tbody>\n";
	var divId3dMap = {};
	var divId2dMap = {};
	for (var i = 0; i < aminoAcidList.length; i++) {
	    var aa = aminoAcidList[i];

	    var divId3d = aa + "3dDiv";
	    divId3dMap[aa] = divId3d;

	    var divId2d = aa + "2dDiv";
	    divId2dMap[aa] = divId2d;

	    tableContents += "<tr><td>" + aa + "</td>\n";

            var aaUrl = "amino_acids/" + aa + ".pdb";
            var divContents = "<div id=\"" + divId3d + "\" style=\"height: 200px; width: 200px; position: relative;\" ";
	    divContents += "class=\"viewer_3Dmoljs\" data-href=\"" + aaUrl + "\" ";
	    divContents += "data-backgroundcolor=\"0xffffff\" data-style=\"stick\">";
            divContents += "</div>";
            console.log(divContents);
	    tableContents += "<td>" + divContents + "</td>\n";
	    tableContents += "<td><div id=\"" + divId2d + "\">2D structure goes here</div></td></tr>\n";
	}
	tableContents += "</tbody></table>\n";

	$("#tableDiv").append(tableContents);

	return [divId3dMap, divId2dMap];
};

var build3DmolViewers = function(divId3dMap) {
	for (var aa in divId3dMap) {
		var aaUrl = "amino_acids/" + aa + ".pdb";
		$.ajax({url: aaUrl, aa:aa, success: function(aaPdb) {
			var divId = divId3dMap[this.aa];	
			
			var content = "<div style=\"height: 400px; width: 400px; position: relative;\" ";
			content = content + "class=\"viewer_3Dmoljs\" data-href=\"4poc_A73-I78.pdb\" data-backgroundcolor=\"0xffffff\" ";
			content = content + "data-style=\"stick\"";

			console.log(content)
/*			var myviewer = $3Dmol.createViewer(divId);
			myviewer.setBackgroundColor(0xffffff);
			myviewer.addModel(aaPdb, "pdb");
			myviewer.setStyle({}, {stick:{}});
			myviewer.zoomTo();
			myviewer.render();*/
			console.log(aaPdb.substring(0,100));
		}});
	}
};

var maps = buildTableFun(aminoAcidList);
//build3DmolViewers(maps[0]);

</script>
</html>

