<html>
<head>
<script src="https://3Dmol.csb.pitt.edu/build/3Dmol.js"></script>
<script src="script_protein.js"></script>
</head>
<body>
<h2>1.3.6 TIMS's trick #1</h2>
<input type="submit" value="sticks" onclick="swapView(this.value)"/>
<input type="submit" value="spheres" onclick="swapView(this.value)"/>
<input type="submit" value="h-bonding" onclick="swapView(this.value)"/>
<br/>

surface parameters<br/>
opacity:  <input type="text" id="surfaceOpacityInput" value="0.6"/>  
color:  <input type="text" id="surfaceColorInput" value="0x3090C7"/>  
<input type="submit" value="redraw surface" onclick="redrawSurface()"/><br/>

<div id="3DMolViewerDiv" style="height: 600px; width: 600px; position: relative;"></div>

</body>
<script>
var swapViewer = null;
var pdbData = null;

var hBondAtomPairSerialNumbers = [[6400,7662], [6401,7662], [7655,5263], [7657,5263]];

function swapView(viewName) {
	console.log("swapView viewName:  " + viewName);

	swapViewer.removeAllShapes();

	if ("sticks" == viewName) {
		swapViewer.setStyle({resn:"13P"}, {stick:$tsol3d.defaultStickStyle});
		swapViewer.setStyle({resi:"165"}, {stick:$tsol3d.defaultStickStyle});
		swapViewer.setStyle({resi:"95"}, {stick:$tsol3d.defaultStickStyle});
	} else if ("spheres" == viewName) {
		swapViewer.setStyle({resn:"13P"}, {sphere:{colorscheme:$tsol3d.defaultElementColors}});
		swapViewer.setStyle({resi:"165"}, {sphere:{colorscheme:$tsol3d.defaultElementColors}});
		swapViewer.setStyle({resi:"95"}, {sphere:{colorscheme:$tsol3d.defaultElementColors}});
	} else if ("h-bonding" == viewName) {
		swapViewer.setStyle({resn:"13P"}, {stick:$tsol3d.defaultStickStyle});
		swapViewer.setStyle({resi:"165"}, {stick:$tsol3d.defaultStickStyle});
		swapViewer.setStyle({resi:"95"}, {stick:$tsol3d.defaultStickStyle});
		$tsol3d.addHBonds(swapViewer, hBondAtomPairSerialNumbers);
	}

	swapViewer.render();
};

function redrawSurface() {
	swapViewer.removeAllSurfaces();
	var curOpacity = $("#surfaceOpacityInput").val();
	var curColor = $("#surfaceColorInput").val();
        swapViewer.addSurface("VDW", {opacity:curOpacity, color:curColor});
	
};

$(document).ready(function() {
	swapViewer = $3Dmol.createViewer("3DMolViewerDiv");
	
	$.ajax({url: "https://www.broadinstitute.org/~dlahr/tsol_3dmol/1ney_cleanedHETATM_justChainB.pdb", success: function(_4PocPdb) {
		pdbData = _4PocPdb;

		swapViewer.addModel(pdbData, "pdb", {keepH:true});
		swapViewer.setBackgroundColor(0xffffff);
		redrawSurface();
		swapViewer.setStyle({}, {stick:{hidden:true}});
		swapView("sticks");
		swapViewer.zoomTo();
		swapViewer.render();
	}});
})
</script>
</html>
